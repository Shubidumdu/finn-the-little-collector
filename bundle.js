(()=>{"use strict";const t=document.getElementById("layer1");function i(){t.width=window.innerWidth,t.height=window.innerHeight,(()=>{const t=document.querySelector("meta[name='viewport']"),i=Math.round(visualViewport.scale*visualViewport.width),e=Math.round(visualViewport.scale*visualViewport.height);i<=460||e<=460?t.setAttribute("content","width=device-width, initial-scale=0.5, user-scalable=0"):i<=768||e<=768?t.setAttribute("content","width=device-width, initial-scale=0.725, user-scalable=0"):t.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=0")})()}const e=function(t){const i=t.getContext("2d");return e=>{i.save(),i.beginPath(),e(i,t),i.closePath(),i.restore()}}(t),s=function(t){const i=t.getContext("2d");return()=>{i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height)}}(t);i(),window.addEventListener("resize",i);const a=t=>Math.PI/180*t,o=t=>Math.floor(Math.random()*t),n=(t=32,i="Arial Black, Arial, sans-serif")=>`bold ${t}pt ${i}`,h=()=>`#${Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0")}`,r=t=>t[o(t.length)];var l,c,f,d,w,p=function(t,i,e,s){if("a"===e&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof i?t!==i||!s:!i.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===e?s:"a"===e?s.call(t):s?s.value:i.get(t)};const u=["#634e34","#2e536f","#1c7847"],m=["#8d5524","#c68642","#e0ac69","#f1c27d","#ffdbac"];class y{constructor(){this.init=t=>{const{position:i,colors:e}=t;this.position=i,this.colors=e,this.isEnlarged=!1},this.update=t=>{this.draw(t)},this.remove=()=>{},this.draw=t=>{e(((i,e)=>{i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x+-2*this.sizeRatio,this.position.y+(26+2*Math.sin(t/64))*this.sizeRatio),i.rotate(a(-8*Math.sin(t/128))),p(this,c,"f").call(this,i),i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x,this.position.y+(24+2*Math.sin(t/128))*this.sizeRatio),p(this,f,"f").call(this,i),i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x,this.position.y+(63+2*Math.sin(t/128))*this.sizeRatio),p(this,d,"f").call(this,i),i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x,this.position.y+70*this.sizeRatio),i.rotate(a(14*Math.sin(t/128)-2)),p(this,w,"f").call(this,i),i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x+14*this.sizeRatio,this.position.y+70*this.sizeRatio),i.rotate(a(5+-14*Math.sin(t/128))),p(this,w,"f").call(this,i),i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x,this.position.y+2*Math.sin(t/128)*this.sizeRatio),p(this,l,"f").call(this,i),i.setTransform(this.sizeRatio,0,0,this.sizeRatio,this.position.x+18*this.sizeRatio,this.position.y+(26+2*Math.sin(t/64))*this.sizeRatio),i.rotate(a(8*Math.sin(t/128))),p(this,c,"f").call(this,i)}))},l.set(this,(t=>{t.fillStyle=this.colors.skin,t.fillRect(0,0,24,24),t.fillStyle=this.colors.eye,t.fillRect(4,8,4,4),t.fillRect(12,8,4,4),t.fillStyle=this.colors.hair,t.fillRect(-4,-8,28,12),t.fillRect(20,-4,6,20)})),c.set(this,(t=>{t.fillStyle=this.colors.top,t.fillRect(0,0,8,38),t.fillStyle=this.colors.skin,t.fillRect(0,38,8,8)})),f.set(this,(t=>{t.fillStyle=this.colors.top,t.fillRect(0,0,24,40)})),d.set(this,(t=>{t.fillStyle=this.colors.bottom,t.fillRect(0,0,24,12)})),w.set(this,(t=>{t.fillStyle=this.colors.bottom,t.fillRect(0,0,10,24),t.fillStyle=this.colors.shoe,t.fillRect(-2,23,12,8)}))}get sizeRatio(){return this.isEnlarged?1:.5}}l=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap,w=new WeakMap;class R{constructor(){this.start=()=>{this.persons=[...new Array(100)].map((()=>new y)),this.persons.forEach((i=>{i.init({position:{x:o(t.width),y:o(t.height),z:0},colors:{hair:h(),eye:r(u),skin:r(m),top:h(),bottom:h(),shoe:h()}})}))},this.update=t=>{this.persons.forEach((i=>i.update(t)))},this.end=()=>{this.persons.forEach((t=>t.remove()))},this.persons=[]}}var v,g,M,z,b,k=function(t,i,e,s){if("a"===e&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof i?t!==i||!s:!i.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===e?s:"a"===e?s.call(t):s?s.value:i.get(t)};class S{constructor(){this.start=()=>{k(this,v,"f").call(this)},this.update=t=>{k(this,z,"f").call(this),k(this,b,"f").call(this,t)},this.end=()=>{k(this,g,"f").call(this)},v.set(this,(()=>{window.addEventListener("keydown",k(this,M,"f"))})),g.set(this,(()=>{window.removeEventListener("keydown",k(this,M,"f"))})),M.set(this,(t=>{"Space"===t.code&&window.postMessage({type:"change-scene",payload:"game"},window.origin)})),z.set(this,(()=>{e(((t,i)=>{t.setTransform(1,0,0,1,i.width/2-120,i.height/2-200),t.font=n(24),t.fillText("Sample Game",0,0)}))})),b.set(this,(t=>{e(((i,e)=>{i.setTransform(1,0,0,1,e.width/2-100,e.height/2+2*Math.sin(t/60)),i.font=n(12),i.fillText("Press spacebar to start",0,0)}))}))}}v=new WeakMap,g=new WeakMap,M=new WeakMap,z=new WeakMap,b=new WeakMap;var T,E,W,x=function(t,i,e,s){if("a"===e&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof i?t!==i||!s:!i.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===e?s:"a"===e?s.call(t):s?s.value:i.get(t)};T=new WeakMap,E=new WeakMap,W=new WeakMap,(new class{constructor(){this.start=()=>{this.scenes[this.activeScene].start(),requestAnimationFrame(x(this,E,"f")),x(this,W,"f").call(this)},T.set(this,(t=>{this.scenes[this.activeScene].end(),this.activeScene=t,this.scenes[this.activeScene].start()})),E.set(this,(t=>{console.log(t),s(),this.scenes[this.activeScene].update(t),requestAnimationFrame(x(this,E,"f"))})),W.set(this,(()=>{window.addEventListener("message",(t=>{if(!t.data)return;const{type:i,payload:e}=t.data;switch(i){case"change-scene":x(this,T,"f").call(this,e)}}))})),this.activeScene="game",this.scenes={game:new R,title:new S}}}).start()})();