(()=>{"use strict";const t=document.getElementById("layer1");function e(){t.width=window.innerWidth,t.height=window.innerHeight,(()=>{const t=document.querySelector("meta[name='viewport']"),e=Math.round(visualViewport.scale*visualViewport.width),s=Math.round(visualViewport.scale*visualViewport.height);e<=460||s<=460?t.setAttribute("content","width=device-width, initial-scale=0.5, user-scalable=0"):e<=768||s<=768?t.setAttribute("content","width=device-width, initial-scale=0.725, user-scalable=0"):t.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=0")})()}const s=function(t){const e=t.getContext("2d");return s=>{e.save(),e.beginPath(),s(e,t),e.closePath(),e.restore()}}(t),i=function(t){const e=t.getContext("2d");return()=>{e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height)}}(t);e(),window.addEventListener("resize",e);var a,n,r,o,h,c=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};class l{constructor(){a.add(this),this.init=t=>{const{position:e,speed:s}=t;this.speed=s,this.position=e,c(this,o,"f").call(this)},this.remove=()=>{c(this,h,"f").call(this)},this.update=t=>{c(this,a,"m",n).call(this,t)},r.set(this,(t=>{"ArrowLeft"===t.key&&(this.position.x-=this.speed),"ArrowRight"===t.key&&(this.position.x+=this.speed),"ArrowUp"===t.key&&(this.position.y-=this.speed),"ArrowDown"===t.key&&(this.position.y+=this.speed)})),o.set(this,(()=>{window.addEventListener("keydown",c(this,r,"f"))})),h.set(this,(()=>{window.removeEventListener("keydown",c(this,r,"f"))}))}}r=new WeakMap,o=new WeakMap,h=new WeakMap,a=new WeakSet,n=function(t){s((t=>{const{x:e,y:s}=this.position;t.setTransform(1,0,0,1,e,s),t.fillRect(0,0,20,20)}))};const w=44100,d=new(window.AudioContext||webkitAudioContext),p=(t=1,e=.05,s=220,i=0,a=0,n=.1,r=0,o=1,h=0,c=0,l=0,d=0,p=0,f=0,u=0,m=0,v=0,y=1,M=0,g=0)=>{let k,b,A=2*Math.PI,E=h*=500*A/w/w,W=s*=(1+2*e*Math.random()-e)*A/w,T=[],x=0,S=0,C=0,L=1,P=0,B=0,V=0;for(i=i*w+9,M*=w,a*=w,n*=w,v*=w,c*=500*A/Math.pow(w,3),u*=A/w,l*=A/w,d*=w,p=p*w|0,b=i+M+a+n+v|0;C<b;T[C++]=V)++B%(100*m|0)||(V=r?r>1?r>2?r>3?Math.sin(Math.pow(x%A,3)):Math.max(Math.min(Math.tan(x),1),-1):1-(2*x/A%2+2)%2:1-4*Math.abs(Math.round(x/A)-x/A):Math.sin(x),V=(p?1-g+g*Math.sin(A*C/p):1)*(V>0?1:-1)*Math.pow(Math.abs(V),o)*t*.2*(C<i?C/i:C<i+M?1-(C-i)/M*(1-y):C<i+M+a?y:C<b-v?(b-C-v)/n*y:0),V=v?V/2+(v>C?0:(C<b-v?1:(b-C)/v)*T[C-v|0]/2):V),k=(s+=h+=c)*Math.cos(u*S++),x+=k-k*f*(1-1e9*(Math.sin(C)+1)%2),L&&++L>d&&(s+=l,W+=l,L=0),!p||++P%p||(s=W,h=E,L=L||1);return T},f=[[[,0,400],[.6,0,4e3,,,.03,2,1.25,,,,,.02,6.8,-.3,,.5],[.6,0,655,,,.09,3,1.65,,,,,.02,3.8,-.1,,.2],[,0,25,.002,.02,.08,3,,,,,,,,,.1,.01]],[[[,,22,22,25,29,22,22,25,29,20,20,24,27,20,20,24,27,18,18,22,25,18,18,22,25,20,20,24,27,29,27,25,24],[1,-.2,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22],[2,.2,,,22,,,,22,,,,22,,,,22,,,,22,,,,22,,,,22,,,22,22,22],[3,,10,,13,10,,10,13,10,,8,,15,8,,12,,6,,10,13,,6,10,13,,8,,12,15,17,15,13]]],[0],68];class u{constructor(){this.start=()=>{this.player.init({speed:10,position:{x:50,y:50}}),this.music.play(!0)},this.update=t=>{this.player.update(t)},this.end=()=>{this.player.remove(),this.music.stop()},this.player=new l,this.music=new class{constructor(t){this.play=(t=!1)=>{this.player=((...t)=>{let e=d.createBuffer(t.length,t[0].length,w),s=d.createBufferSource();return t.map(((t,s)=>e.getChannelData(s).set(t))),s.buffer=e,s.connect(d.destination),s.start(),s})(...this.buffer),this.player.loop=t},this.stop=()=>{this.player.stop()},this.buffer=((t,e,s,i=125)=>{let a,n,r,o,h,c,l,d,f,u,m,v,y,M,g,k=0,b=[],A=[],E=[],W=0,T=0,x=1,S={},C=w/i*60>>2;for(;x;W++)b=[x=d=m=y=0],s.map(((i,w)=>{for(l=e[i][W]||[0,0,0],x|=!!e[i][W],g=y+(e[i][0].length-2-!d)*C,M=w==s.length-1,n=2,o=y;n<l.length+M;d=++n){for(h=l[n],f=n==l.length+M-1&&M||u!=(l[0]||0)|h|0,r=0;r<C&&d;r++>C-99&&f?v+=(v<1)/99:0)c=(1-v)*b[k++]/2||0,A[o]=(A[o]||0)-c*T+c,E[o]=(E[o++]||0)+c*T+c;h&&(v=h%1,T=l[1]||0,(h|=0)&&(b=S[[u=l[k=0]||0,h]]=S[[u,h]]||(a=[...t[u]],a[2]*=Math.pow(2,(h-12)/12),h>0?p(...a):[])))}y=g}));return[A,E]})(...t)}}(f)}}const m=(t=32,e="Arial Black, Arial, sans-serif")=>`bold ${t}pt ${e}`;var v,y,M,g,k,b=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};class A{constructor(){this.start=()=>{b(this,v,"f").call(this)},this.update=t=>{b(this,g,"f").call(this),b(this,k,"f").call(this,t)},this.end=()=>{b(this,y,"f").call(this)},v.set(this,(()=>{window.addEventListener("keydown",b(this,M,"f"))})),y.set(this,(()=>{window.removeEventListener("keydown",b(this,M,"f"))})),M.set(this,(t=>{"Space"===t.code&&window.postMessage({type:"change-scene",payload:"game"},window.origin)})),g.set(this,(()=>{s(((t,e)=>{t.setTransform(1,0,0,1,e.width/2-120,e.height/2-200),t.font=m(24),t.fillText("Sample Game",0,0)}))})),k.set(this,(t=>{s(((e,s)=>{e.setTransform(1,0,0,1,s.width/2-100,s.height/2+2*Math.sin(t/60)),e.font=m(12),e.fillText("Press spacebar to start",0,0)}))}))}}v=new WeakMap,y=new WeakMap,M=new WeakMap,g=new WeakMap,k=new WeakMap;var E,W,T,x=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};E=new WeakMap,W=new WeakMap,T=new WeakMap,(new class{constructor(){this.start=()=>{this.scenes[this.activeScene].start(),requestAnimationFrame(x(this,W,"f")),x(this,T,"f").call(this)},E.set(this,(t=>{this.scenes[this.activeScene].end(),this.activeScene=t,this.scenes[this.activeScene].start()})),W.set(this,(t=>{i(),this.scenes[this.activeScene].update(t),requestAnimationFrame(x(this,W,"f"))})),T.set(this,(()=>{window.addEventListener("message",(t=>{if(!t.data)return;const{type:e,payload:s}=t.data;switch(e){case"change-scene":x(this,E,"f").call(this,s)}}))})),this.activeScene="title",this.scenes={game:new u,title:new A}}}).start()})();