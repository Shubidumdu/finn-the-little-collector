(()=>{"use strict";const t=document.getElementById("layer1");function e(){t.width=window.innerWidth,t.height=window.innerHeight,(()=>{const t=document.querySelector("meta[name='viewport']"),e=Math.round(visualViewport.scale*visualViewport.width),s=Math.round(visualViewport.scale*visualViewport.height);e<=460||s<=460?t.setAttribute("content","width=device-width, initial-scale=0.5, user-scalable=0"):e<=768||s<=768?t.setAttribute("content","width=device-width, initial-scale=0.725, user-scalable=0"):t.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=0")})()}const s=function(t){const e=t.getContext("2d");return s=>{e.save(),e.beginPath(),s(e,t),e.closePath(),e.restore()}}(t),i=function(t){const e=t.getContext("2d");return()=>{e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height)}}(t);e(),window.addEventListener("resize",e);const n=(t=32,e="Arial Black, Arial, sans-serif")=>`bold ${t}pt ${e}`;class o{constructor(){this.init=t=>{const{position:e}=t;this.position=e,this.move={speed:3e3,position:{x:200,y:0,z:0}}},this.update=t=>{this.draw(t);const{isProgressing:e,progress:s,isEnded:i,isReserved:n}=(({time:t,start:e,duration:s})=>{const i=(t-e)/s<0?0:(t-e)/s;return{isProgressing:i<1&&i>0,progress:i,isReserved:(t-e)/s<0,isEnded:(t-e)/s>1}})({time:t,start:1e3,duration:this.move.speed});n&&(this.move={speed:4e3,position:{x:400,y:400,z:0}}),e&&(this.position={x:this.position.x+(this.move.position.x-this.position.x)*s,y:this.position.y+(this.move.position.y-this.position.y)*s,z:this.position.z}),i&&(this.position={x:this.move.position.x,y:this.move.position.y,z:0})},this.remove=()=>{},this.draw=t=>{s((t=>{const{x:e,y:s,z:i}=this.position;t.setTransform(1,0,0,1,e,s),t.fillRect(0,0,20,20)}))}}}class a{constructor(){this.start=()=>{this.person.init({position:{x:0,y:0,z:0}})},this.update=t=>{this.person.update(t)},this.end=()=>{this.person.remove()},this.person=new o}}var r,h,c,d,l,w=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};class p{constructor(){this.start=()=>{w(this,r,"f").call(this)},this.update=t=>{w(this,d,"f").call(this),w(this,l,"f").call(this,t)},this.end=()=>{w(this,h,"f").call(this)},r.set(this,(()=>{window.addEventListener("keydown",w(this,c,"f"))})),h.set(this,(()=>{window.removeEventListener("keydown",w(this,c,"f"))})),c.set(this,(t=>{"Space"===t.code&&window.postMessage({type:"change-scene",payload:"game"},window.origin)})),d.set(this,(()=>{s(((t,e)=>{t.setTransform(1,0,0,1,e.width/2-120,e.height/2-200),t.font=n(24),t.fillText("Sample Game",0,0)}))})),l.set(this,(t=>{s(((e,s)=>{e.setTransform(1,0,0,1,s.width/2-100,s.height/2+2*Math.sin(t/60)),e.font=n(12),e.fillText("Press spacebar to start",0,0)}))}))}}r=new WeakMap,h=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap;var u,m,v,f=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};u=new WeakMap,m=new WeakMap,v=new WeakMap,(new class{constructor(){this.start=()=>{this.scenes[this.activeScene].start(),requestAnimationFrame(f(this,m,"f")),f(this,v,"f").call(this)},u.set(this,(t=>{this.scenes[this.activeScene].end(),this.activeScene=t,this.scenes[this.activeScene].start()})),m.set(this,(t=>{console.log(t),i(),this.scenes[this.activeScene].update(t),requestAnimationFrame(f(this,m,"f"))})),v.set(this,(()=>{window.addEventListener("message",(t=>{if(!t.data)return;const{type:e,payload:s}=t.data;switch(e){case"change-scene":f(this,u,"f").call(this,s)}}))})),this.activeScene="game",this.scenes={game:new a,title:new p}}}).start()})();